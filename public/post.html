<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <title>Post â€” Yarnly</title>
  <meta name="description" content="Yarnly blog post"/>
  <meta property="og:title" content="Yarnly Blog"/>
  <link rel="canonical" href="/post.html"/>
  <meta property="og:image" content="/public/images/hero-yarn.svg"/>
  <link rel="preload" as="style" href="/public/styles.css"/>
  <link rel="stylesheet" href="/public/styles.css"/>
</head>
<body>
  <header>
    <div class="container nav">
      <div class="row"><div class="hamburger" id="hamburger"><span></span><span></span><span></span></div><a class="brand" href="/">Yarnly</a></div>
      <nav class="links hide-mobile"><a href="/shop.html">Shop</a><a href="/blog.html">Blog</a></nav>
      <div class="actions"><span id="account-link"><a href="/login.html">Sign In</a></span> <a class="btn-ghost btn-icon" href="/cart.html">Cart <span id="cart-count"></span></a></div>
    </div>
    <div id="mobile-nav" class="mobile-nav"><a href="/shop.html">Shop</a><a href="/blog.html">Blog</a></div>
  </header>
  <main class="container" style="max-width:820px">
    <article class="card"><div class="pad">
      <h1 id="title">Post</h1>
      <div id="date" class="muted"></div>
      <div id="content"></div>
    </div></article>
  </main>
  <script type="module" src="/public/app.js"></script>
  <script>
    function qs(k){return new URLSearchParams(location.search).get(k)}
    function md(str=''){
      return str
        .replace(/\*\*(.+?)\*\*/g,'<strong>$1</strong>')
        .replace(/\*(.+?)\*/g,'<em>$1</em>')
        .replace(/^### (.+)$/gm,'<h3>$1</h3>')
        .replace(/^## (.+)$/gm,'<h2>$1</h2>')
        .replace(/^# (.+)$/gm,'<h1>$1</h1>')
        .replace(/`([^`]+)`/g,'<code>$1</code>')
        .replace(/\n\n/g,'</p><p>')
    }
    const id = Number(qs('id'));
    fetch('/api/posts/'+id).then(r=>r.json()).then(p=>{
      document.getElementById('title').textContent=p.title||'Untitled';
      document.getElementById('date').textContent=new Date(p.createdAt||Date.now()).toDateString();
      const html = `<p>${md(p.content||p.excerpt||'')}</p>`;
      document.getElementById('content').innerHTML = html;
    });
  </script>
</body>
</html>
